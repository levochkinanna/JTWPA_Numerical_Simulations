* author: Anna Levochkina
* This script describing Reversed Kerr TWPA based on SNAIL design with N = 250 SNAILs
* We introduced a small induactance in every SNAIL assosiated with an outside inductance via mutual inductance 
* in order to perform flux bias 

* I define variabile wich I will use for current setting in the additional loop
.options cur=0.0
* Pump with amplitude 0.35uA @ 4GHz
Ip Vin 0 sin(0 0.35u 4.415e9 0 0 0)
* Signal which should be amplified with amplitude 0.06uA @3.9GHz
Is Vin 0 sin(0 0.06u 4.215e9 0 0 0)

* Input Resistor 50 Ohm in order to avoid impedance mismatch
R1 Vin 0 50
* Output Resistor 50 Ohm in order to avoid impedance mismatch
R2 V250 0 50

*This adding voltage sources were put in order to see the voltage drop across all nodes of the device
V0 Vin V000

* Circiut description
X001 V000 V001a SNAIL
V1 V001a V001
X002 V001 V002a SNAILREV
V2 V002a V002
X003 V002 V003a SNAIL
V3 V003a V003
X004 V003 V004a SNAILREV
V4 V004a V004
X005 V004 V005a SNAIL
V5 V005a V005
X006 V005 V006a SNAILREV
V6 V006a V006
X007 V006 V007a SNAIL
V7 V007a V007
X008 V007 V008a SNAILREV
V8 V008a V008
X009 V008 V009a SNAIL
V9 V009a V009
X010 V009 V010a SNAILREV
V10 V010a V010
X011 V010 V011a SNAIL
V11 V011a V011
X012 V011 V012a SNAILREV
V12 V012a V012
X013 V012 V013a SNAIL
V13 V013a V013
X014 V013 V014a SNAILREV
V14 V014a V014
X015 V014 V015a SNAIL
V15 V015a V015
X016 V015 V016a SNAILREV
V16 V016a V016
X017 V016 V017a SNAIL
V17 V017a V017
X018 V017 V018a SNAILREV
V18 V018a V018
X019 V018 V019a SNAIL
V19 V019a V019
X020 V019 V020a SNAILREV
V20 V020a V020
X021 V020 V021a SNAIL
V21 V021a V021
X022 V021 V022a SNAILREV
V22 V022a V022
X023 V022 V023a SNAIL
V23 V023a V023
X024 V023 V024a SNAILREV
V24 V024a V024
X025 V024 V025a SNAIL
V25 V025a V025
X026 V025 V026a SNAILREV
V26 V026a V026
X027 V026 V027a SNAIL
V27 V027a V027
X028 V027 V028a SNAILREV
V28 V028a V028
X029 V028 V029a SNAIL
V29 V029a V029
X030 V029 V030a SNAILREV
V30 V030a V030
X031 V030 V031a SNAIL
V31 V031a V031
X032 V031 V032a SNAILREV
V32 V032a V032
X033 V032 V033a SNAIL
V33 V033a V033
X034 V033 V034a SNAILREV
V34 V034a V034
X035 V034 V035a SNAIL
V35 V035a V035
X036 V035 V036a SNAILREV
V36 V036a V036
X037 V036 V037a SNAIL
V37 V037a V037
X038 V037 V038a SNAILREV
V38 V038a V038
X039 V038 V039a SNAIL
V39 V039a V039
X040 V039 V040a SNAILREV
V40 V040a V040
X041 V040 V041a SNAIL
V41 V041a V041
X042 V041 V042a SNAILREV
V42 V042a V042
X043 V042 V043a SNAIL
V43 V043a V043
X044 V043 V044a SNAILREV
V44 V044a V044
X045 V044 V045a SNAIL
V45 V045a V045
X046 V045 V046a SNAILREV
V46 V046a V046
X047 V046 V047a SNAIL
V47 V047a V047
X048 V047 V048a SNAILREV
V48 V048a V048
X049 V048 V049a SNAIL
V49 V049a V049
X050 V049 V050a SNAILREV
V50 V050a V050
X051 V050 V051a SNAIL
V51 V051a V051
X052 V051 V052a SNAILREV
V52 V052a V052
X053 V052 V053a SNAIL
V53 V053a V053
X054 V053 V054a SNAILREV
V54 V054a V054
X055 V054 V055a SNAIL
V55 V055a V055
X056 V055 V056a SNAILREV
V56 V056a V056
X057 V056 V057a SNAIL
V57 V057a V057
X058 V057 V058a SNAILREV
V58 V058a V058
X059 V058 V059a SNAIL
V59 V059a V059
X060 V059 V060a SNAILREV
V60 V060a V060
X061 V060 V061a SNAIL
V61 V061a V061
X062 V061 V062a SNAILREV
V62 V062a V062
X063 V062 V063a SNAIL
V63 V063a V063
X064 V063 V064a SNAILREV
V64 V064a V064
X065 V064 V065a SNAIL
V65 V065a V065
X066 V065 V066a SNAILREV
V66 V066a V066
X067 V066 V067a SNAIL
V67 V067a V067
X068 V067 V068a SNAILREV
V68 V068a V068
X069 V068 V069a SNAIL
V69 V069a V069
X070 V069 V070a SNAILREV
V70 V070a V070
X071 V070 V071a SNAIL
V71 V071a V071
X072 V071 V072a SNAILREV
V72 V072a V072
X073 V072 V073a SNAIL
V73 V073a V073
X074 V073 V074a SNAILREV
V74 V074a V074
X075 V074 V075a SNAIL
V75 V075a V075
X076 V075 V076a SNAILREV
V76 V076a V076
X077 V076 V077a SNAIL
V77 V077a V077
X078 V077 V078a SNAILREV
V78 V078a V078
X079 V078 V079a SNAIL
V79 V079a V079
X080 V079 V080a SNAILREV
V80 V080a V080
X081 V080 V081a SNAIL
V81 V081a V081
X082 V081 V082a SNAILREV
V82 V082a V082
X083 V082 V083a SNAIL
V83 V083a V083
X084 V083 V084a SNAILREV
V84 V084a V084
X085 V084 V085a SNAIL
V85 V085a V085
X086 V085 V086a SNAILREV
V86 V086a V086
X087 V086 V087a SNAIL
V87 V087a V087
X088 V087 V088a SNAILREV
V88 V088a V088
X089 V088 V089a SNAIL
V89 V089a V089
X090 V089 V090a SNAILREV
V90 V090a V090
X091 V090 V091a SNAIL
V91 V091a V091
X092 V091 V092a SNAILREV
V92 V092a V092
X093 V092 V093a SNAIL
V93 V093a V093
X094 V093 V094a SNAILREV
V94 V094a V094
X095 V094 V095a SNAIL
V95 V095a V095
X096 V095 V096a SNAILREV
V96 V096a V096
X097 V096 V097a SNAIL
V97 V097a V097
X098 V097 V098a SNAILREV
V98 V098a V098
X099 V098 V099a SNAIL
V99 V099a V099
X100 V099 V100a SNAILREV
V100 V100a V100
X101 V100 V101a SNAIL
V101 V101a V101
X102 V101 V102a SNAILREV
V102 V102a V102
X103 V102 V103a SNAIL
V103 V103a V103
X104 V103 V104a SNAILREV
V104 V104a V104
X105 V104 V105a SNAIL
V105 V105a V105
X106 V105 V106a SNAILREV
V106 V106a V106
X107 V106 V107a SNAIL
V107 V107a V107
X108 V107 V108a SNAILREV
V108 V108a V108
X109 V108 V109a SNAIL
V109 V109a V109
X110 V109 V110a SNAILREV
V110 V110a V110
X111 V110 V111a SNAIL
V111 V111a V111
X112 V111 V112a SNAILREV
V112 V112a V112
X113 V112 V113a SNAIL
V113 V113a V113
X114 V113 V114a SNAILREV
V114 V114a V114
X115 V114 V115a SNAIL
V115 V115a V115
X116 V115 V116a SNAILREV
V116 V116a V116
X117 V116 V117a SNAIL
V117 V117a V117
X118 V117 V118a SNAILREV
V118 V118a V118
X119 V118 V119a SNAIL
V119 V119a V119
X120 V119 V120a SNAILREV
V120 V120a V120
X121 V120 V121a SNAIL
V121 V121a V121
X122 V121 V122a SNAILREV
V122 V122a V122
X123 V122 V123a SNAIL
V123 V123a V123
X124 V123 V124a SNAILREV
V124 V124a V124
X125 V124 V125a SNAIL
V125 V125a V125
X126 V125 V126a SNAILREV
V126 V126a V126
X127 V126 V127a SNAIL
V127 V127a V127
X128 V127 V128a SNAILREV
V128 V128a V128
X129 V128 V129a SNAIL
V129 V129a V129
X130 V129 V130a SNAILREV
V130 V130a V130
X131 V130 V131a SNAIL
V131 V131a V131
X132 V131 V132a SNAILREV
V132 V132a V132
X133 V132 V133a SNAIL
V133 V133a V133
X134 V133 V134a SNAILREV
V134 V134a V134
X135 V134 V135a SNAIL
V135 V135a V135
X136 V135 V136a SNAILREV
V136 V136a V136
X137 V136 V137a SNAIL
V137 V137a V137
X138 V137 V138a SNAILREV
V138 V138a V138
X139 V138 V139a SNAIL
V139 V139a V139
X140 V139 V140a SNAILREV
V140 V140a V140
X141 V140 V141a SNAIL
V141 V141a V141
X142 V141 V142a SNAILREV
V142 V142a V142
X143 V142 V143a SNAIL
V143 V143a V143
X144 V143 V144a SNAILREV
V144 V144a V144
X145 V144 V145a SNAIL
V145 V145a V145
X146 V145 V146a SNAILREV
V146 V146a V146
X147 V146 V147a SNAIL
V147 V147a V147
X148 V147 V148a SNAILREV
V148 V148a V148
X149 V148 V149a SNAIL
V149 V149a V149
X150 V149 V150a SNAILREV
V150 V150a V150
X151 V150 V151a SNAIL
V151 V151a V151
X152 V151 V152a SNAILREV
V152 V152a V152
X153 V152 V153a SNAIL
V153 V153a V153
X154 V153 V154a SNAILREV
V154 V154a V154
X155 V154 V155a SNAIL
V155 V155a V155
X156 V155 V156a SNAILREV
V156 V156a V156
X157 V156 V157a SNAIL
V157 V157a V157
X158 V157 V158a SNAILREV
V158 V158a V158
X159 V158 V159a SNAIL
V159 V159a V159
X160 V159 V160a SNAILREV
V160 V160a V160
X161 V160 V161a SNAIL
V161 V161a V161
X162 V161 V162a SNAILREV
V162 V162a V162
X163 V162 V163a SNAIL
V163 V163a V163
X164 V163 V164a SNAILREV
V164 V164a V164
X165 V164 V165a SNAIL
V165 V165a V165
X166 V165 V166a SNAILREV
V166 V166a V166
X167 V166 V167a SNAIL
V167 V167a V167
X168 V167 V168a SNAILREV
V168 V168a V168
X169 V168 V169a SNAIL
V169 V169a V169
X170 V169 V170a SNAILREV
V170 V170a V170
X171 V170 V171a SNAIL
V171 V171a V171
X172 V171 V172a SNAILREV
V172 V172a V172
X173 V172 V173a SNAIL
V173 V173a V173
X174 V173 V174a SNAILREV
V174 V174a V174
X175 V174 V175a SNAIL
V175 V175a V175
X176 V175 V176a SNAILREV
V176 V176a V176
X177 V176 V177a SNAIL
V177 V177a V177
X178 V177 V178a SNAILREV
V178 V178a V178
X179 V178 V179a SNAIL
V179 V179a V179
X180 V179 V180a SNAILREV
V180 V180a V180
X181 V180 V181a SNAIL
V181 V181a V181
X182 V181 V182a SNAILREV
V182 V182a V182
X183 V182 V183a SNAIL
V183 V183a V183
X184 V183 V184a SNAILREV
V184 V184a V184
X185 V184 V185a SNAIL
V185 V185a V185
X186 V185 V186a SNAILREV
V186 V186a V186
X187 V186 V187a SNAIL
V187 V187a V187
X188 V187 V188a SNAILREV
V188 V188a V188
X189 V188 V189a SNAIL
V189 V189a V189
X190 V189 V190a SNAILREV
V190 V190a V190
X191 V190 V191a SNAIL
V191 V191a V191
X192 V191 V192a SNAILREV
V192 V192a V192
X193 V192 V193a SNAIL
V193 V193a V193
X194 V193 V194a SNAILREV
V194 V194a V194
X195 V194 V195a SNAIL
V195 V195a V195
X196 V195 V196a SNAILREV
V196 V196a V196
X197 V196 V197a SNAIL
V197 V197a V197
X198 V197 V198a SNAILREV
V198 V198a V198
X199 V198 V199a SNAIL
V199 V199a V199
X200 V199 V200a SNAILREV
V200 V200a V200
X201 V200 V201a SNAIL
V201 V201a V201
X202 V201 V202a SNAILREV
V202 V202a V202
X203 V202 V203a SNAIL
V203 V203a V203
X204 V203 V204a SNAILREV
V204 V204a V204
X205 V204 V205a SNAIL
V205 V205a V205
X206 V205 V206a SNAILREV
V206 V206a V206
X207 V206 V207a SNAIL
V207 V207a V207
X208 V207 V208a SNAILREV
V208 V208a V208
X209 V208 V209a SNAIL
V209 V209a V209
X210 V209 V210a SNAILREV
V210 V210a V210
X211 V210 V211a SNAIL
V211 V211a V211
X212 V211 V212a SNAILREV
V212 V212a V212
X213 V212 V213a SNAIL
V213 V213a V213
X214 V213 V214a SNAILREV
V214 V214a V214
X215 V214 V215a SNAIL
V215 V215a V215
X216 V215 V216a SNAILREV
V216 V216a V216
X217 V216 V217a SNAIL
V217 V217a V217
X218 V217 V218a SNAILREV
V218 V218a V218
X219 V218 V219a SNAIL
V219 V219a V219
X220 V219 V220a SNAILREV
V220 V220a V220
X221 V220 V221a SNAIL
V221 V221a V221
X222 V221 V222a SNAILREV
V222 V222a V222
X223 V222 V223a SNAIL
V223 V223a V223
X224 V223 V224a SNAILREV
V224 V224a V224
X225 V224 V225a SNAIL
V225 V225a V225
X226 V225 V226a SNAILREV
V226 V226a V226
X227 V226 V227a SNAIL
V227 V227a V227
X228 V227 V228a SNAILREV
V228 V228a V228
X229 V228 V229a SNAIL
V229 V229a V229
X230 V229 V230a SNAILREV
V230 V230a V230
X231 V230 V231a SNAIL
V231 V231a V231
X232 V231 V232a SNAILREV
V232 V232a V232
X233 V232 V233a SNAIL
V233 V233a V233
X234 V233 V234a SNAILREV
V234 V234a V234
X235 V234 V235a SNAIL
V235 V235a V235
X236 V235 V236a SNAILREV
V236 V236a V236
X237 V236 V237a SNAIL
V237 V237a V237
X238 V237 V238a SNAILREV
V238 V238a V238
X239 V238 V239a SNAIL
V239 V239a V239
X240 V239 V240a SNAILREV
V240 V240a V240
X241 V240 V241a SNAIL
V241 V241a V241
X242 V241 V242a SNAILREV
V242 V242a V242
X243 V242 V243a SNAIL
V243 V243a V243
X244 V243 V244a SNAILREV
V244 V244a V244
X245 V244 V245a SNAIL
V245 V245a V245
X246 V245 V246a SNAILREV
V246 V246a V246
X247 V246 V247a SNAIL
V247 V247a V247
X248 V247 V248a SNAILREV
V248 V248a V248
X249 V248 V249a SNAIL
V249 V249a V249
X250 V249 V250a SNAILREV
V250 V250a V250

* Description of subcircuit SNAIL
.subckt SNAIL Nin Nout
B1 Nin N001 jj1
B2 N001 N002 jj1
B3 N002 Nout jj1
B4 Nin N003 jj2
Lg1 N003 Nout 0.1pH
Cg1 Nin 0 C1
* Outside Circuit for Flux Biasing 
Idc1 0 701 pwl(0 0uA 5ns $c%uA) 
Lflux1 701 0 1.6uH 
K1 Lg1 Lflux1 1
* Define the junction model
.model jj1 jj(level=1) icrit=1.47uA cap=80fF
.model jj2 jj(level=1) icrit=0.0735uA cap=4fF
.param C1=550fF 
.ends SNAIL

* Description subcircuit SNAILREV
.subckt SNAILREV Nin Nout
B1 Nin N001 jj1
B2 N001 N002 jj1
B3 N002 Nout jj1
B4 Nin N003 jj2
Lg1 N003 Nout 0.1pH
Cg1 Nin 0 C1
* Outside Circuit for Flux Biasing 
Idc1 701 0 pwl(0 0uA 5ns $c%uA) 
Lflux1 701 0 1.6uH 
K1 Lg1 Lflux1 1
* Define the junction model
.model jj1 jj(level=1) icrit=1.47uA cap=80fF
.model jj2 jj(level=1) icrit=0.0735uA cap=4fF
.param C1=550fF 
.ends SNAILREV

.option maxdata=4e6
.control
run


*Transient simulation

tran 3.29ps 50ns 0.0ns
* the way possibile format of data saving:   write /mnt/c/dox/wrspice/test/pump=2.3(1).csv i(V0) i(V250)
* there is also possibility of data saving in .txt format

.endc
